@echo off

REM Git 루트 디렉토리로 이동
for /f "delims=" %%i in ('git rev-parse --show-toplevel') do cd "%%i"

echo Running dotnet format...
dotnet format ./src/MSD.Crux
set RESULT=%ERRORLEVEL%

if %RESULT% NEQ 0 (
    echo pre-commit 메시지: 포맷팅 중 문제가 발생했습니다. 포맷팅 규칙에 맞지 않을 수 있습니다.
) else (
    echo pre-commit 메시지: 포맷팅 완료!
)

REM 변경된 파일 다시 스테이징
for /f "delims=" %%f in ('git diff --name-only') do (
    git add "%%f"
)

REM 항상 성공 상태 반환
exit /b 0
